(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[753],{7392:function(e,t,a){Promise.resolve().then(a.bind(a,2186))},2186:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return T}});var n=a(7437),o=a(2265);a(1396);var r=a(9930),c=a(4247),s=a.n(c),l=a(252),i=a.n(l),u=a(1279),d=a(7188),m=a(6677),x=a(3085),h=a(4086);let p=(0,h.ad)(m.Z),b=(0,x.v0)(m.Z),j=()=>{let[e,t]=(0,o.useState)(""),[a,c]=(0,o.useState)(""),[s,l]=(0,o.useState)(""),[m,j]=(0,o.useState)(""),[g,_]=(0,o.useState)(""),{setShowForm:v,setVisibleNewUser:f}=(0,o.useContext)(r.ZP),C=(0,o.useRef)(),{crearProducto:N,setRecargar:w,edit:P,setEdit:y,update:S,setUpdate:Z,actualizarProducto:k,currentFilter:E,setCurrentFilter:F}=(0,o.useContext)(r.ZP),I=async t=>{t.preventDefault();try{let t=await (0,x.Xb)(b,s,m).then(e=>e);console.log("usuario creado con \xe9xito",t);let n=(0,h.JU)(p,"usuarios/".concat(t.user.uid));(0,h.pl)(n,{nombre:e,apellido:a,email:s,rol:g}),console.log("usuario guardado en db")}catch(e){console.log(e)}};return(0,n.jsx)("div",{children:(0,n.jsxs)("form",{ref:C,className:i()["form-new-product"],onSubmit:I,children:[(0,n.jsx)("div",{className:i()["close-btn-container"],children:(0,n.jsx)(u.G,{className:i()["close-btn"],onClick:()=>{f(!1)},icon:d.QQm})}),(0,n.jsxs)("label",{htmlFor:"nombre",children:["nombre",(0,n.jsx)("input",{type:"text",name:"nombre",id:"nombre",value:e,onChange:e=>t(e.target.value)})]}),(0,n.jsxs)("label",{htmlFor:"apellido",children:["apellido",(0,n.jsx)("input",{type:"text",name:"apellido",id:"apellido",value:a,onChange:e=>c(e.target.value)})]}),(0,n.jsxs)("label",{htmlFor:"email",children:["email",(0,n.jsx)("input",{autoComplete:"on",type:"email",name:"email",id:"email",value:s,onChange:e=>l(e.target.value)})]}),(0,n.jsxs)("label",{htmlFor:"password",children:["password",(0,n.jsx)("input",{type:"password",name:"password",id:"password",value:m,onChange:e=>j(e.target.value)})]}),(0,n.jsxs)("label",{htmlFor:"rol",children:["rol",(0,n.jsx)("input",{type:"text",name:"rol",id:"rol",value:g,onChange:e=>_(e.target.value)})]}),(0,n.jsx)("button",{className:i().formBtn,children:"crear usuario"})]})})},g=()=>{let{setCurrentFilter:e,setVisibleSelected:t,setVisibleNewUser:a}=(0,o.useContext)(r.ZP),{setShowForm:c}=(0,o.useContext)(r.ZP);return(0,n.jsxs)("div",{className:s().nav,children:[(0,n.jsx)("button",{onClick:()=>{e([]),t(!1)},children:"Todos los productos"}),(0,n.jsx)("button",{onClick:()=>{c(!0)},children:"Nuevo producto"}),(0,n.jsx)("button",{onClick:()=>{a(!0)},children:"Crear Usuario"})]})},_={nombre:"",precioBase:"",precio:"",cantidad:"",categoria:""},v=()=>{let[e,t]=(0,o.useState)(_),{setShowForm:a}=(0,o.useContext)(r.ZP),c=(0,o.useRef)(),{crearProducto:s,setRecargar:l,edit:m,setEdit:x,update:h,setUpdate:p,actualizarProducto:b,currentFilter:j,setCurrentFilter:g}=(0,o.useContext)(r.ZP),v=async n=>{n.preventDefault();try{await s(e),console.log("producto creado con \xe9xito")}catch(e){console.error("Error al crear el producto",e)}finally{c.current.reset(),t(_),l(!0),a(!1)}},f=async t=>{t.preventDefault();try{j.length>0?(await b(e),g(e),c.current.reset(),x(!1),p(_)):(await b(e),c.current.reset(),x(!1),p(_),g(e),l(!0),a(!1))}catch(e){console.log(e)}};return(0,o.useEffect)(()=>{h&&t(h)},[h]),(0,n.jsx)("div",{children:(0,n.jsxs)("form",{ref:c,className:i()["form-new-product"],onSubmit:m?f:v,children:[(0,n.jsx)("div",{className:i()["close-btn-container"],children:(0,n.jsx)(u.G,{className:i()["close-btn"],onClick:()=>{p({nombre:"",precioBase:"",precio:"",cantidad:"",categoria:""}),a(!1),x(!1)},icon:d.QQm})}),(0,n.jsx)("label",{htmlFor:"nombre",children:"nombre"}),(0,n.jsx)("input",{type:"text",name:"nombre",id:"nombre",value:e.nombre,onChange:a=>t({...e,nombre:a.target.value})}),(0,n.jsx)("label",{htmlFor:"precioBase",children:"precio base"}),(0,n.jsx)("input",{type:"number",name:"precioBase",id:"precioBase",value:e.precioBase,onChange:a=>t({...e,precioBase:a.target.value})}),(0,n.jsx)("label",{htmlFor:"precio",children:"precio"}),(0,n.jsx)("input",{type:"number",name:"precio",id:"precio",value:e.precio,onChange:a=>t({...e,precio:a.target.value})}),(0,n.jsx)("label",{htmlFor:"cantidad",children:"cantidad"}),(0,n.jsx)("input",{type:"number",name:"cantidad",id:"cantidad",value:e.cantidad,onChange:a=>t({...e,cantidad:a.target.value})}),(0,n.jsx)("label",{htmlFor:"categoria",children:"categor\xeda"}),(0,n.jsx)("input",{type:"text",name:"categoria",id:"categoria",value:e.categoria,onChange:a=>t({...e,categoria:a.target.value})}),m?(0,n.jsx)("button",{className:i().formBtn,children:"modificar producto"}):(0,n.jsx)("button",{className:i().formBtn,children:"crear producto"})]})})};var f=a(6073),C=a.n(f);let N=()=>{let{data:e,search:t,setSearch:a,currentFilter:c,setCurrentFilter:s,setTable:l,setVisibleSelected:i}=(0,o.useContext)(r.ZP),u=e=>{s(e),i(!0),a("")};return(0,n.jsxs)("div",{className:C()["search-container"],children:[(0,n.jsx)("div",{className:C()["search-input-container"],children:(0,n.jsx)("input",{id:"auto",placeholder:"Search",value:t,onChange:e=>a(e.target.value)})}),t&&(0,n.jsx)("div",{className:C()["auto-container"],children:e.filter(e=>e.nombre.toLowerCase().includes(t.toLowerCase())).map((e,t)=>(0,n.jsxs)("div",{className:C()["autocomplete-item"],onClick:()=>u(e),children:[(0,n.jsx)("h4",{children:e.nombre.toLowerCase()}),(0,n.jsx)("h4",{children:e.cantidad.toLowerCase()})]},t))})]})};var w=a(2759),P=a(3764),y=a.n(P);let S=e=>{let{borrarProducto:t,setTable:a,setEdit:c,update:s,setUpdate:l,setVisibleSelected:i,pagination:d,setPagination:m,setShowForm:x}=(0,o.useContext)(r.ZP),{product:h,onDeleteProduct:p,index:b}=e,j=e=>{c(!0),l(e),x(!0)};return(0,n.jsxs)("tr",{className:y()["fila-tabla"],children:[(0,n.jsx)("td",{children:h.nombre}),(0,n.jsx)("td",{children:h.precioBase}),(0,n.jsx)("td",{children:h.precio}),(0,n.jsx)("td",{children:h.cantidad}),(0,n.jsx)("td",{children:h.categoria}),(0,n.jsx)("td",{children:(0,n.jsx)("button",{className:y().botones,onClick:()=>j(h),children:(0,n.jsx)(u.G,{className:y().icono,icon:w._3l})})}),(0,n.jsx)("td",{children:(0,n.jsx)("button",{className:y().botones,onClick:()=>p(h),children:(0,n.jsx)(u.G,{className:y().icono,icon:w.Vui})})})]})};var Z=a(4890),k=a.n(Z),E=()=>{let{data:e,currentFilter:t,visibleSelected:a,pagination:c,setPagination:s,borrarProducto:l,setRecargar:i}=(0,o.useContext)(r.ZP),[u,d]=(0,o.useState)(0),m=(0,o.useMemo)(()=>Math.ceil(e.length/15),[e]),x=(0,o.useMemo)(()=>a?[t]:[],[a,t]),h=e=>{d(e),s({currentPage:e,minIndexPage:15*e,maxIndexPage:15*(e+1)})},p=async e=>{try{await l(e),console.log("Producto eliminado con \xe9xito")}catch(e){console.error("Error al borrar el producto")}finally{a?await i(!0):(s({currentPage:0,maxIndexPage:15,minIndexPage:0}),d(0))}};return(0,n.jsxs)("div",{className:k()["table-content"],children:[(0,n.jsx)("table",{className:k()["products-table"],children:(0,n.jsxs)("tbody",{children:[(0,n.jsxs)("tr",{className:k()["table-titles"],children:[(0,n.jsx)("th",{children:"Nombre"}),(0,n.jsx)("th",{children:"Precio Base"}),(0,n.jsx)("th",{children:"Precio"}),(0,n.jsx)("th",{children:"Cantidad"}),(0,n.jsx)("th",{children:"Categor\xeda"})]}),x.map((e,t)=>(0,n.jsx)(S,{product:e,index:t,onDeleteProduct:p},t)),!a&&e.slice(c.minIndexPage,c.maxIndexPage).map((e,t)=>(0,n.jsx)(S,{product:e,index:t,onDeleteProduct:p},t))]})}),(0,n.jsx)("div",{className:k().pagination,children:!a&&Array.from({length:m},(e,t)=>(0,n.jsx)("button",{className:"".concat(k()["pagination-item"]," ").concat(t===u?k().active:""),onClick:()=>h(t),children:t+1},t))})]})},F=a(5360),I=a.n(F),B=a(7171),D=a(4033);function T(){let{showForm:e,visibleNewUser:t}=(0,o.useContext)(r.ZP),{userRole:a,setRutaProhibida:c,rutaProhibida:s,userLoading:l}=(0,o.useContext)(B.Z),i=(0,D.useRouter)(),{push:u}=i;return(0,o.useEffect)(()=>{l||(console.log(a),"admin"!==a&&(c(!0),i.push("/Salon")))},[a,l,c,i]),(0,n.jsx)(n.Fragment,{children:s?(0,n.jsx)(n.Fragment,{}):(0,n.jsxs)("div",{className:I()["app-container"],children:[(0,n.jsxs)("div",{className:I()["controls-container"],children:[(0,n.jsx)(N,{}),(0,n.jsx)(g,{}),e&&(0,n.jsx)("div",{className:I()["new-product-container"],children:(0,n.jsx)(v,{})}),t&&(0,n.jsx)("div",{className:I()["new-product-container"],children:(0,n.jsx)(j,{})})]}),(0,n.jsx)("div",{className:I()["table-container"],children:(0,n.jsx)(E,{})})]})})}},7171:function(e,t,a){"use strict";a.d(t,{H:function(){return u}});var n=a(7437),o=a(2265),r=a(6677),c=a(3085),s=a(4086);let l=(0,s.ad)(r.Z),i=(0,o.createContext)(),u=e=>{let{children:t}=e,[a,u]=(0,o.useState)(null),[d,m]=(0,o.useState)(null),[x,h]=(0,o.useState)(!1),[p,b]=(0,o.useState)(!0),j=(0,c.v0)(r.Z),g=async e=>{let t=(0,s.JU)(l,"usuarios/".concat(e)),a=await (0,s.QT)(t),n=a.data();return n};return(0,o.useEffect)(()=>{let e=(0,c.Aj)(j,async e=>{try{if(e){let t=await g(e.uid);if(t){let a={uid:e.uid,email:e.email,nombre:t.nombre,apellido:t.apellido,rol:t.rol};console.log(j.currentUser),u(a),m(t.rol)}else console.error("Los datos del usuario no est\xe1n disponibles.")}else u(null);b(!1)}catch(e){console.error("Error al obtener datos del usuario:",e)}});return()=>e()},[j]),(0,n.jsx)(i.Provider,{value:{user:a,setUser:u,userRole:d,setRutaProhibida:h,rutaProhibida:x,userLoading:p},children:t})};t.Z=i},9930:function(e,t,a){"use strict";a.d(t,{xi:function(){return d}});var n=a(7437),o=a(2265),r=a(7171),c=a(6677),s=a(3085),l=a(4086);let i=(0,l.ad)(c.Z),u=(0,o.createContext)(),d=e=>{let{children:t}=e,[a,d]=(0,o.useState)([]),[m,x]=(0,o.useState)(!1),[h,p]=(0,o.useState)(!0),[b,j]=(0,o.useState)(!1),[g,_]=(0,o.useState)(""),[v,f]=(0,o.useState)([]),[C,N]=(0,o.useState)(!1),[w,P]=(0,o.useState)(!1),[y,S]=(0,o.useState)(!1),[Z,k]=(0,o.useState)(null),[E,F]=(0,o.useState)({currentPage:0,maxIndexPage:15,minIndexPage:0});(0,s.v0)(c.Z);let{user:I}=(0,o.useContext)(r.Z),B=async e=>{try{await (0,l.ET)((0,l.hJ)(i,"productos"),{...e}),console.log("Producto creado con \xe9xito")}catch(e){console.log(e)}},D=async e=>{try{await (0,l.oe)((0,l.JU)(i,"productos",e.id)),x(!0)}catch(e){console.error(e)}},T=async e=>{try{let t=(0,l.JU)(i,"productos",e.id);await (0,l.pl)(t,e),x(!0)}catch(e){console.error("Error al actualizar el producto:",e)}};return(0,o.useEffect)(()=>{if(I){let e=async()=>{try{let e=await (0,l.PL)((0,l.hJ)(i,"productos")),t=[];e.forEach(e=>{t.push({...e.data(),id:e.id})}),d(t),p(!1),console.log("fetch desde data")}catch(e){console.log(e)}};e()}x(!1)},[m,I]),(0,n.jsx)(u.Provider,{value:{data:a,crearProducto:B,borrarProducto:D,edit:b,setEdit:j,update:Z,setUpdate:k,actualizarProducto:T,search:g,setSearch:_,currentFilter:v,setCurrentFilter:f,visibleSelected:C,setVisibleSelected:N,pagination:E,setPagination:F,setShowForm:P,showForm:w,recargar:m,setRecargar:x,setIsLoading:p,visibleNewUser:y,setVisibleNewUser:S},children:t})};t.ZP=u},6677:function(e,t,a){"use strict";var n=a(994);let o=(0,n.ZF)({apiKey:"AIzaSyCPoFDVhJEAu33lNxC1gOiYbr2TvADIpgQ",authDomain:"barcome-4054b.firebaseapp.com",projectId:"barcome-4054b",storageBucket:"barcome-4054b.appspot.com",messagingSenderId:"241982700888",appId:"1:241982700888:web:f1f218f72c25c13270792d"});t.Z=o},4247:function(e){e.exports={nav:"adminNav_nav__VcRdy"}},5360:function(e){e.exports={"app-container":"home_app-container__3muoD","controls-container":"home_controls-container__EITgC","table-container":"home_table-container__6aa_I","new-product-container":"home_new-product-container__koFYs"}},252:function(e){e.exports={"form-new-product":"newProduct_form-new-product__r4VHj",formBtn:"newProduct_formBtn__NysDi","close-btn-container":"newProduct_close-btn-container__dk5C9","close-btn":"newProduct_close-btn__3YNJI"}},6073:function(e){e.exports={"search-container":"search_search-container__vPziu","search-input-container":"search_search-input-container__oLrG1","auto-container":"search_auto-container__Ftd_G","autocomplete-item":"search_autocomplete-item__LNmiz"}},3764:function(e){e.exports={"fila-tabla":"testRow_fila-tabla__HE2z7",botones:"testRow_botones__D8N9V",icono:"testRow_icono__hhHTi"}},4890:function(e){e.exports={"products-table":"testTable_products-table__7HOPy","table-content":"testTable_table-content__seMEG",pagination:"testTable_pagination__k0Xzf","pagination-item":"testTable_pagination-item__DHCSc",active:"testTable_active__dgo7C"}},4033:function(e,t,a){e.exports=a(8165)}},function(e){e.O(0,[358,487,676,647,988,154,396,971,596,744],function(){return e(e.s=7392)}),_N_E=e.O()}]);